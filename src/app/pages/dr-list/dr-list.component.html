<div class="container-fluid bg-light min-vh-100 py-4">
    <div class="container-fluid px-4">

        <!-- Page Header -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <h3 class="fw-bold text-dark mb-1">Qnopy DR Documentation</h3>
                        <p class="text-muted mb-0">Manage and maintain DR procedures and runbooks</p>
                    </div>
                    <div>
                        <button class="btn btn-primary btn-sm" (click)="addDoc()">
                            Add Document
                        </button>

                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Search Bar -->
        <div class="row mb-3">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-body py-3">
                        <div class="row g-3 align-items-center">
                            <div class="col-md-5">
                                <div class="input-group">
                                    <span class="input-group-text bg-white border-end-0">
                                        <i class="bi bi-search text-muted"></i>
                                    </span>
                                    <input type="text" class="form-control border-start-0 ps-0"
                                        placeholder="Search by title, component, or keyword..." />
                                </div>
                            </div>
                            <!-- Component Filter -->
<div class="col-md-3">
  <select
    class="form-select form-select-sm"
    [(ngModel)]="selectedComponent"
    (change)="onComponentChange()"
  >
    <option value="">All Components</option>

    <!-- Compute -->
    <option value="EC2">EC2</option>
    <option value="ECS">ECS</option>
    <option value="EKS">EKS</option>
    <option value="LAMBDA">Lambda</option>

    <!-- Networking -->
    <option value="ALB">Application Load Balancer</option>
    <option value="NLB">Network Load Balancer</option>
    <option value="VPC">VPC</option>
    <option value="API">API Gateway</option>
    <option value="CLOUDFRONT">CloudFront</option>

    <!-- Database -->
    <option value="RDS">RDS</option>
    <option value="AURORA">Aurora</option>
    <option value="DYNAMODB">DynamoDB</option>
    <option value="ELASTICACHE">ElastiCache</option>

    <!-- Storage -->
    <option value="S3">S3</option>
    <option value="EBS">EBS</option>
    <option value="EFS">EFS</option>

    <!-- Observability / Security -->
    <option value="CLOUDWATCH">CloudWatch</option>
    <option value="IAM">IAM</option>
    <option value="WAF">WAF</option>

    <!-- Application -->
    <option value="APP">Application</option>
  </select>
</div>

<!-- Sort -->
<div class="col-md-2">
  <select
    class="form-select form-select-sm"
    [(ngModel)]="sortBy"
    (change)="onSortChange()"
  >
    <option value="latest">Sort: Latest</option>
    <option value="oldest">Oldest</option>
  </select>
</div>

<!-- Export -->
<!-- <div class="col-md-2 text-end">
  <button
    class="btn btn-outline-secondary btn-sm"
    (click)="exportDocs()"
  >
    Export
  </button>
</div> -->

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Cards -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <div class="bg-primary bg-opacity-10 p-3 rounded">
                                    <i class="bi bi-file-earmark-text text-primary fs-4"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="text-muted mb-1 text-uppercase" style="font-size: 0.7rem;">Total Documents
                                </h6>
                                <h4 class="mb-0 fw-bold">{{ drDocs?.length || 0 }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <div class="bg-success bg-opacity-10 p-3 rounded">
                                    <i class="bi bi-check-circle text-success fs-4"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="text-muted mb-1 text-uppercase" style="font-size: 0.7rem;">Active</h6>
                                <h4 class="mb-0 fw-bold">{{ drDocs?.length || 0 }}</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <div class="bg-warning bg-opacity-10 p-3 rounded">
                                    <i class="bi bi-clock-history text-warning fs-4"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="text-muted mb-1 text-uppercase" style="font-size: 0.7rem;">Last Updated</h6>
<h4 class="mb-0 fw-bold" style="font-size: 1.1rem;">
  {{ getLastUpdatedDate() ? (getLastUpdatedDate() | date:'MMM dd, yyyy') : 'N/A' }}
</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <div class="bg-info bg-opacity-10 p-3 rounded">
                                    <i class="bi bi-hdd-stack text-info fs-4"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="text-muted mb-1 text-uppercase" style="font-size: 0.7rem;">Components</h6>
                                <h4 class="mb-0 fw-bold">4</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Table -->
        <div class="row">
            <div class="col-12">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom py-3">
                        <h6 class="mb-0 fw-semibold">DR Document Repository</h6>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th class="border-0 ps-4" style="width: 40%;">
                                            <span class="text-muted text-uppercase fw-semibold"
                                                style="font-size: 0.75rem;">
                                                Document Title
                                            </span>
                                        </th>
                                        <th class="border-0" style="width: 15%;">
                                            <span class="text-muted text-uppercase fw-semibold"
                                                style="font-size: 0.75rem;">
                                                Component
                                            </span>
                                        </th>
                                        <th class="border-0" style="width: 15%;">
                                            <span class="text-muted text-uppercase fw-semibold"
                                                style="font-size: 0.75rem;">
                                                Status
                                            </span>
                                        </th>
                                        <th class="border-0" style="width: 18%;">
                                            <span class="text-muted text-uppercase fw-semibold"
                                                style="font-size: 0.75rem;">
                                                Created Date
                                            </span>
                                        </th>
                                        <th class="border-0 pe-4 text-end" style="width: 12%;">
                                            <span class="text-muted text-uppercase fw-semibold"
                                                style="font-size: 0.75rem;">
                                                Actions
                                            </span>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr *ngFor="let doc of drDocs" class="border-bottom">
                                        <td class="ps-4 py-3">
                                            <div class="d-flex align-items-center">
                                                <div class="bg-primary bg-opacity-10 rounded p-2 me-3">
                                                    <i class="bi bi-file-earmark-text text-primary"></i>
                                                </div>
                                                <div>
                                                    <h6 class="mb-0 fw-semibold">{{ doc.title }}</h6>
                                                    <small class="text-muted">ID: {{ doc.id }}</small>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="py-2">
                                            <span class="badge text-uppercase fw-semibold" [ngClass]="{
      'bg-primary': ['EC2','ECS','EKS','LAMBDA'].includes(doc.component),
      'bg-success': ['ALB','NLB','VPC','CLOUDFRONT','API'].includes(doc.component),
      'bg-info': ['RDS','AURORA','DYNAMODB','ELASTICACHE'].includes(doc.component),
      'bg-secondary': ['S3','EBS','EFS'].includes(doc.component),
      'bg-dark': ['IAM','WAF','CLOUDWATCH'].includes(doc.component),
      'bg-warning text-dark': doc.component === 'APP'
    }" style="font-size: 0.7rem; padding: 0.35rem 0.7rem;">
                                                {{ doc.component }}
                                            </span>
                                        </td>

                                        <td class="py-3">
                                            <span class="badge bg-success-subtle text-success border border-success"
                                                style="font-size: 0.7rem; padding: 0.35rem 0.7rem;">
                                                <i class="bi bi-check-circle-fill me-1"></i>Active
                                            </span>
                                        </td>
                                        <td class="py-3">
                                            <div>
                                                <div class="text-dark mb-1">{{ doc.createdAt | date:'MMM dd, yyyy' }}
                                                </div>
                                                <small class="text-muted">{{ doc.createdAt | date:'h:mm a' }}</small>
                                            </div>
                                        </td>
                                        <td class="pe-4 py-3 text-end">
                                            <div class="btn-group btn-group-sm" role="group">
                                                <button type="button" class="btn btn-outline-primary"
                                                    title="View Details" (click)="viewDoc(doc.id!)">
                                                    <i class="bi bi-eye"></i>
                                                </button>
                                                <button type="button" class="btn btn-outline-secondary"
                                                    (click)="editDoc(doc.id!)" title="Edit Document">
                                                    <i class="bi bi-pencil"></i>
                                                </button>
                                               <button
  type="button"
  class="btn btn-outline-danger"
  title="Delete Document"
  (click)="deleteDoc(doc.id!)"
>
  <i class="bi bi-trash"></i>
</button>

                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <!-- Empty State -->
                        <div *ngIf="!drDocs || drDocs.length === 0" class="text-center py-5">
                            <div class="mb-3">
                                <i class="bi bi-inbox text-muted" style="font-size: 4rem;"></i>
                            </div>
                            <h5 class="text-muted mb-2">No DR Documents Found</h5>
                            <p class="text-muted mb-4">Get started by creating your first disaster recovery document</p>
                            <button class="btn btn-primary" (click)="addDoc()">
                                <i class="bi bi-plus-circle me-2"></i>Create First Document
                            </button>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="card-footer bg-white border-top py-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="text-muted small">
                                Showing <strong>{{ drDocs?.length || 0 }}</strong> of <strong>{{ drDocs?.length || 0
                                    }}</strong> documents
                            </div>
                            <nav aria-label="Table pagination">
                                <ul class="pagination pagination-sm mb-0">
                                    <li class="page-item disabled">
                                        <a class="page-link" href="#" tabindex="-1">Previous</a>
                                    </li>
                                    <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                    <li class="page-item"><a class="page-link" href="#">2</a></li>
                                    <li class="page-item"><a class="page-link" href="#">3</a></li>
                                    <li class="page-item">
                                        <a class="page-link" href="#">Next</a>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>